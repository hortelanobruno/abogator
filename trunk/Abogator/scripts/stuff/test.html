<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>JSP Page</title>
    </head>
    <script type="text/javascript">
	
        /**
         * Function : dump()
         * Arguments: The data - array,hash(associative array),object
         *    The level - OPTIONAL
         * Returns  : The textual representation of the array.
         * This function was inspired by the print_r function of PHP.
         * This will accept some data as the argument and return a
         * text that will be a more readable version of the
         * array/hash/object that is given.
         * Docs: http://www.openjs.com/scripts/others/dump_function_php_print_r.php
         */
        function dump(arr,level) {
            var dumped_text = "";
            if(!level) level = 0;
	
            //The padding given at the beginning of the line.
            var level_padding = "";
            for(var j=0;j<level+1;j++) level_padding += "    ";
	
            if(typeof(arr) == 'object') { //Array/Hashes/Objects 
                for(var item in arr) {
                    var value = arr[item];
			
                    if(typeof(value) == 'object') { //If it is an array,
                        dumped_text += level_padding + "'" + item + "' ...\n";
                        dumped_text += dump(value,level+1);
                    } else {
                        dumped_text += level_padding + "'" + item + "' => \"" + value + "\"\n";
                    }
                }
            } else { //Stings/Chars/Numbers etc.
                dumped_text = "===>"+arr+"<===("+typeof(arr)+")";
            }
            return dumped_text;
        }

        var mes_nombre=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];
        var meses=["2010 Junio","2010 Julio","2010 Agosto","2010 Septiembre","2010 Octubre","2010 Noviembre","2010 Diciembre","2011 Enero",
            "2011 Febrero","2011 Marzo","2011 Abril","2011 Mayo","2011 Junio","2011 Julio","2011 Agosto","2011 Septiembre","2011 Octubre",
            "2011 Noviembre","2011 Diciembre","2012 Enero","2012 Febrero","2012 Marzo","2012 Abril","2012 Mayo","2012 Junio","2012 Julio",
            "2012 Agosto","2012 Septiembre","2012 Octubre","2012 Noviembre","2012 Diciembre","2013 Enero","2013 Febrero","2013 Marzo","2013 Abril"];
        var categorias=["Maestranza y Servicios: A","Maestranza y Servicios: B","Maestranza y Servicios: C","Administrativo: A",
            "Administrativo: B","Administrativo: C","Administrativo: D","Administrativo: E","Administrativo: F","Cajero: A","Cajero: B",
            "Cajero: C","Personal Auxiliar: A","Personal Auxiliar: B","Personal Auxiliar: C","Auxiliar Especializado: A",
            "Auxiliar Especializado: B","Ventas: A","Ventas: B","Ventas: C","Ventas: D"];
  
        var fruits = ["Banana", "Orange", "Apple", "Mango"];
        var a = fruits.indexOf("Apple");
  
        var db = [[[
                ["Sueldo basico",false,0],
                ["Antiguedad",0,0],
                ["Presentismo",1/12,0]
            ],[
                ["Sueldo basico",false,0],
                ["Antiguedad",0,0],
                ["Presentismo",1/12,0]
            ]]];//mapa, indice catindex => mesindex => objeto (sueldo, valores no rem)
    
        var sueldo={
            rem:[
                ["Sueldo basico",false,0],
                ["Antiguedad",0,0],
                ["Presentismo",1/12,0]
            ],
            nrem:[
                ["Adicional no remunerativo 2008-2009",false,0],
                ["Adicional no remunerativo 2010",false,0],
                ["Adicional no remunerativo 2011",false,0],
                ["Acuerdo mayo 2012", false, 0],
                ["Retroactivo Acuerdo mayo-2011",false,0],
                ["Retroactivo Acuerdo mayo-2012",false,0],
                ["Presentismo",1/12,0]
            ],
            desc:[
                ["Jubilacion",0.11,0],
                ["Ley 19032",0.03,0],
                ["Obra social",0.03,0],
                ["Faecys",0.005,0],
                ["Sindicato",0.02,0],
                ["Aporte solidario Obra social","",0],
                ["Aporte solidario Obra social (mayo)","",0]
            ],
            title:"Sueldo"
        }
        var sac={
            rem:[
                ["SAC",false,0]
            ],
            nrem:[
                ["SAC Adicional no remunerativo 2008-2009",false,0],
                ["SAC Adicional no remunerativo 2010",false,0],
                ["SAC Adicional no remunerativo 2011",false,0],
                ["SAC Adicional no remunerativo 2012",false,0]
            ],
            desc:[
                ["Jubilacion",0.11,0],
                ["Ley 19032",0.03,0],
                ["Obra social",0.03,0],
                ["Faecys",0.005,0],
                ["Sindicato",0.02,0]
            ],
            title:"Sueldo anual complementario"
        }
		
        var data={
            sueldo:[2000],
            antiguedad:[1],
            presentismo:[true],
            mes:["2012 Enero"],
            categoria:["Cat1"],
            convenio:["Convenio1"],
            lunes:[9,18,true],
            martes:[9,18,true],
            miercoles:[9,18,true],
            jueves:[9,18,true],
            viernes:[9,18,true],
            sabado:[9,12,false],
            domingo:[9,12,false]}
		
        function cargarDatos(){
		
		
        }
		
        function generarDatos(){
            var ret=[sueldo,false];
            sueldo.rem[0][2]=data.sueldo[0];
            sueldo.rem[1][2]=data.sueldo[0]*0.01*data.antiguedad[0];
            sueldo.rem[2][2]=data.presentismo[0]?(sueldo.rem[0][2]+sueldo.rem[1][2])/12:0;
            sueldo.rem.total=total(sueldo.rem);
			
            sueldo.nrem.total=0;
			
            sueldo.desc[0][2]=sueldo.desc[0][1]*sueldo.rem.total;
            sueldo.desc[1][2]=sueldo.desc[1][1]*sueldo.rem.total;
            sueldo.desc[2][2]=sueldo.desc[2][1]*(sueldo.rem.total+sueldo.nrem.total);
            sueldo.desc[3][2]=sueldo.desc[3][1]*(sueldo.rem.total+sueldo.nrem.total);
            sueldo.desc[4][2]=sueldo.desc[4][1]*(sueldo.rem.total+sueldo.nrem.total);
            //sueldo.desc[5][2]=(mes==0||mes==12||mes==13)?50:(mes==23?100:0);
            //sueldo.desc[6][2]=mes==24&&retro?100:0;
            sueldo.desc.total=total(sueldo.desc);
			
			
            if((data.mes[0].indexOf("Junio") != -1)||(data.mes[0].indexOf("Diciembre") != -1)){
                ret[1]=sac;
                
                sac.rem[0][2]=sueldo.rem.total*0.5;
                sac.rem.total=total(sac.rem);
                
                //sac.nrem[0][2]=val[1]*(1+(pre?1/12:0))*0.5;
                //sac.nrem[1][2]=val[2]*(1+(pre?1/12:0))*0.5;
                //sac.nrem[2][2]=val[3]*(1+(pre?1/12:0))*(mes==12?2/12:0.5);
                //sac.nrem[3][2]=val[4]*(1+(pre?1/12:0))*(mes==24?2/12:0.5);
                sac.nrem.total=0;
                
                sac.desc[0][2]=sac.desc[0][1]*sac.rem.total;
                sac.desc[1][2]=sac.desc[1][1]*sac.rem.total;
                sac.desc[2][2]=sac.desc[2][1]*(sac.rem.total+sac.nrem.total);
                sac.desc[3][2]=sac.desc[3][1]*(sac.rem.total+sac.nrem.total);
                sac.desc[4][2]=sac.desc[4][1]*(sac.rem.total+sac.nrem.total);
                sac.desc.total=total(sac.desc); 
            }
			
            function total(obj){
                var ret=0;
                for(var i=0;i<obj.length;i++){
                    ret+=obj[i][2];
                }
                return ret;
            }
			
            return ret;
        }
		
        function calculate(){
            cargarDatos();
            var datos = generarDatos();
            var table = document.getElementById('table');
            var w = 0;
            var totaldiv = document.createElement('tr');
            totaldiv.innerHTML = '<td>Total</td><td></td>';
            for(var i=0;i<datos.length;i++){
                for(var det in datos[i]){
                    if(!/obj|title/.test(det)){
                        for(var j=0;j<datos[i][det].length;j++){
                            if(datos[i][det][j]){
                                if(datos[i][det][j][2]){
                                    var newdiv = document.createElement('tr');
                                    newdiv.innerHTML = '<td>'+datos[i][det][j][0]+'</td>';
                                    newdiv.innerHTML = newdiv.innerHTML+'<td>5%</td>';
                                    for(var q=0; q<=2 ; q++){
                                        if(q==w){
                                            newdiv.innerHTML = newdiv.innerHTML+ '<td>'+datos[i][det][j][2]+'</td>';
                                        }else{
                                            newdiv.innerHTML = newdiv.innerHTML+ '<td></td>';
                                        }
                                    }
                                    table.appendChild(newdiv);
                                }
                            }
                        }
                        totaldiv.innerHTML = totaldiv.innerHTML + '<td>'+datos[i][det].total+'</td>';
                        w++;
                    }
                }	
            }
            table.appendChild(totaldiv);
        }
    </script>
    <body onload="calculate()">
        <h1>Hello World!</h1>
        <table id="esc_rec">
            <caption>Recibo de sueldo</caption>
            <thead>
                <tr><th colspan="2"></th><th>Remunerativo</th><th>No Remunerativo</th><th>Descuentos</th></tr>
            </thead>
            <tbody>
                <tr><td>Sueldo básico</td><td></td><td class="moneda"><b>$</b>4.058,78</td><td></td><td></td></tr>
                <tr><td>Presentismo</td><td>8,33 %</td><td class="moneda"><b>$</b>338,23</td><td></td><td></td></tr>
                <tr><td>Presentismo</td><td>8,33 %</td><td></td><td class="moneda"><b>$</b>50,73</td><td></td></tr>
                <tr><td>Jubilación</td><td>11,00 %</td><td></td><td></td><td class="moneda"><b>$</b>483,67</td></tr>
                <tr><td>Ley 19032</td><td>3,00 %</td><td></td><td></td><td class="moneda"><b>$</b>131,91</td></tr>
                <tr><td>Obra social</td><td>3,00 %</td><td></td><td></td><td class="moneda"><b>$</b>151,70</td></tr>
                <tr><td>Faecys</td><td>0,50 %</td><td></td><td></td><td class="moneda"><b>$</b>25,28</td></tr>
                <tr><td>Sindicato</td><td>2,00 %</td><td></td><td></td><td class="moneda"><b>$</b>101,13</td></tr>
            </tbody>
            <tbody style="display: none; "></tbody>
            <tbody>
                <tr class="rec_total"><td>Totales</td><td></td><td class="moneda"><b>$</b>4.397,01</td><td class="moneda"><b>$</b>659,55</td><td class="moneda"><b>$</b>893,69</td></tr>
                <tr class="rec_total_neto"><td>Sueldo neto a cobrar</td><td></td><td class="moneda"><b>$</b></td><td class="moneda"><b>$</b></td><td class="moneda"><b>$</b>4.162,87</td></tr>
            </tbody></table>
        <br/>
        <br/>
        <table id="table">
        </table>
    </body>
</html>
